{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Ejercicios 7\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 1. Carga de datos"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "[Movilens Dataset](http://grouplens.org/datasets/movielens/) recoge datos de 6000 usuarios y 4000  películas. Un total de 1.000.000 de entradas. La información se distribuye en 3 tablas.\n",
    "\n",
    "- ratings.dat - El fichero recoge datos de valoraciones  de los usuarios\n",
    "- movies.dat - Datos de las películas\n",
    "- users.dat - Datos personales de los usuarios\n",
    "\n",
    "\n",
    "Toda esta información se utiliza con mucha frecuencia en los sistemas de recomendación que aplican algoritmos de aprendizaje.\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Pasos a seguir:\n",
    "\n",
    "__Paso 1__. Descargar los siguientes ficheros de datos en el directorio de trabajo.\n",
    "\n",
    "[users](./ml-1m/users.dat)\n",
    "\n",
    "[movies](./ml-1m/movies.dat)\n",
    "\n",
    "[ratings](./ml-1m/ratings.dat)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__Paso 2__. Crear un DataFrame para cada uno de los ficheros.  Usar la función head() para visualizar los primeros datos.\n",
    "\n",
    "* Los dataframes han de llamarse: `usuarios`, `peliculas` y `valoraciones`.\n",
    "* Con respecto a la carga del fichero ratings (tenéis la instrucción de carga más abajo): \n",
    "    * tiene un campo de tipo fecha expresado en segundos. \n",
    "    * Indica en la función __read_csv__ que vas a parsear esa columna como una fecha.\n",
    "    * Utiliza la función __datetime.fromtimestamp__ para parsear las fechas.  Para ello tendrás que indicarlo en el parámetro __date_parser__ de la función __read_table__."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "import matplotlib as mpl\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "%matplotlib inline\n",
    "\n",
    "ruta_ratings = './ml-1m/ratings.dat'    # AQUÍ PONER LA RUTA DEL FICHERO\n",
    "ruta_movies = './ml-1m/movies.dat'\n",
    "ruta_usuarios = './ml-1m/users.dat'\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_usuario</th>\n",
       "      <th>id_peli</th>\n",
       "      <th>puntuacion</th>\n",
       "      <th>Fecha</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1193</td>\n",
       "      <td>5</td>\n",
       "      <td>2000-12-31 23:12:40</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>661</td>\n",
       "      <td>3</td>\n",
       "      <td>2000-12-31 23:35:09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>914</td>\n",
       "      <td>3</td>\n",
       "      <td>2000-12-31 23:32:48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>3408</td>\n",
       "      <td>4</td>\n",
       "      <td>2000-12-31 23:04:35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>2355</td>\n",
       "      <td>5</td>\n",
       "      <td>2001-01-07 00:38:11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_usuario  id_peli  puntuacion               Fecha\n",
       "0           1     1193           5 2000-12-31 23:12:40\n",
       "1           1      661           3 2000-12-31 23:35:09\n",
       "2           1      914           3 2000-12-31 23:32:48\n",
       "3           1     3408           4 2000-12-31 23:04:35\n",
       "4           1     2355           5 2001-01-07 00:38:11"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Sol apartado 1:\n",
    "\n",
    "from datetime import datetime\n",
    "dateparse = lambda x: datetime.fromtimestamp(float(x))\n",
    "\n",
    "valoraciones = pd.read_csv(ruta_ratings, sep = '::', header = None,\n",
    "                         names = ['id_usuario', 'id_peli', 'puntuacion', 'Fecha'],\n",
    "                         engine ='python',\n",
    "                         parse_dates=[3], date_parser=dateparse)\n",
    "                         \n",
    "\n",
    "valoraciones.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_usuario</th>\n",
       "      <th>genero</th>\n",
       "      <th>edad</th>\n",
       "      <th>Ocupacion</th>\n",
       "      <th>CP</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>48067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>M</td>\n",
       "      <td>56</td>\n",
       "      <td>16</td>\n",
       "      <td>70072</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>M</td>\n",
       "      <td>25</td>\n",
       "      <td>15</td>\n",
       "      <td>55117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>M</td>\n",
       "      <td>45</td>\n",
       "      <td>7</td>\n",
       "      <td>02460</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>M</td>\n",
       "      <td>25</td>\n",
       "      <td>20</td>\n",
       "      <td>55455</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_usuario genero  edad  Ocupacion     CP\n",
       "0           1      F     1         10  48067\n",
       "1           2      M    56         16  70072\n",
       "2           3      M    25         15  55117\n",
       "3           4      M    45          7  02460\n",
       "4           5      M    25         20  55455"
      ]
     },
     "execution_count": 78,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "usuarios = pd.read_csv(ruta_usuarios, sep = '::', header = None,\n",
    "                         names = ['id_usuario', 'genero', 'edad', 'Ocupacion', 'CP'],\n",
    "                         engine ='python')\n",
    "usuarios.head()\n",
    "                         "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_peli</th>\n",
       "      <th>Titulo</th>\n",
       "      <th>Genero</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "      <td>Animation|Children's|Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jumanji (1995)</td>\n",
       "      <td>Adventure|Children's|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Waiting to Exhale (1995)</td>\n",
       "      <td>Comedy|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Father of the Bride Part II (1995)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_peli                              Titulo                        Genero\n",
       "0        1                    Toy Story (1995)   Animation|Children's|Comedy\n",
       "1        2                      Jumanji (1995)  Adventure|Children's|Fantasy\n",
       "2        3             Grumpier Old Men (1995)                Comedy|Romance\n",
       "3        4            Waiting to Exhale (1995)                  Comedy|Drama\n",
       "4        5  Father of the Bride Part II (1995)                        Comedy"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "peliculas = pd.read_csv(ruta_movies, sep = '::', header = None,\n",
    "                         names = ['id_peli', 'Titulo', 'Genero'],\n",
    "                         engine ='python')\n",
    "peliculas.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "#### 2. Diagrama de Frecuencias"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Los usuarios valoran las películas con valores del 1 al 5 donde el 1 es la peor puntuación y 5 es la mejor. La puntuación es una variable categórica. \n",
    "Representa mediante un diagrama de Frecuencias (tipo hist) la frecuencia de los votos de la película con título __X-Men (2000)__.\n",
    "\n",
    "El gráfico que tienes que construir debe tener el siguiente aspecto:\n",
    "\n",
    "![Diagrama](mi_diagrama.png)\n",
    "\n",
    "__Notas:__\n",
    "\n",
    "* El título de la película está en el dataframe __películas__."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_peli</th>\n",
       "      <th>Titulo</th>\n",
       "      <th>Genero</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3724</th>\n",
       "      <td>3793</td>\n",
       "      <td>X-Men (2000)</td>\n",
       "      <td>Action|Sci-Fi</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      id_peli        Titulo         Genero\n",
       "3724     3793  X-Men (2000)  Action|Sci-Fi"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "peliculas[peliculas.Titulo=='X-Men (2000)']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [],
   "source": [
    "xmen=valoraciones[valoraciones.id_peli==3793]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x121d72c18>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "xmen['puntuacion'].plot(kind='hist',\n",
    "                        bins =5,\n",
    "                       title='Puntuaciones de Xmen');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "#### 3. Puntuación media"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Calcula la puntuación media  de cada película por sexo del usuario. Diseña una función llamada __puntuacion_media__ que devuelve un Dataframe donde el índice es el título de la película y las columnaa son 'F' y 'M' (Female y Male respectivamente).\n",
    "\n",
    "__Nota__:\n",
    "Hay varias formas de hacerlo. Aquí os dejo alguna sugerencia:\n",
    "* Necesitamos combinar las tres tablas ya que tenemos, por un lado las valoraciones, por otro el título de la película y por otro el sexo de los usuarios. La operación merge te permitirá realizar la  combinación\n",
    "    * Combina primero las valoraciones con las peliculas por el campo 'id_peli'.\n",
    "    * Combina el resultado anterior con los usuarios por el campo 'id_usuario'.\n",
    "    \n",
    "* Una vez combinadas las tres tablas en una sola tabla:\n",
    "    * solución 1:  Agrupar por id_peli y por sexo del usuario. La función de agregación es la media mean(). Para obtener la tabla pedida utiliza `unstack` para deshacer el multi índice.\n",
    "    * solución 2: Consulta la ayuda de la función __pivot_table__. Utiliza la función __pivot_table__. Esta no la hemos visto en la teoría, pero es muy interesante y útil. Merece la pena que intentéis resolverlo también utilizando esta opción.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# Sol:\n",
    "def puntuacion_media():\n",
    "    \"\"\"Calcula la puntuación media  de cada película por sexo del usuario\n",
    "    \n",
    "    Example:\n",
    "        >>> puntuacion_media()\n",
    "        genero_u                            F          M\n",
    "        titulo \n",
    "        $1,000,000 Duck (1971)       3.375000    2.761905\n",
    "        'Night Mother (1986)         3.388889    3.352941\n",
    "        'Til There Was You (1997)    2.675676    2.733333\n",
    "\n",
    "\"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_usuario</th>\n",
       "      <th>id_peli</th>\n",
       "      <th>puntuacion</th>\n",
       "      <th>Fecha</th>\n",
       "      <th>Titulo</th>\n",
       "      <th>Genero</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1193</td>\n",
       "      <td>5</td>\n",
       "      <td>2000-12-31 23:12:40</td>\n",
       "      <td>One Flew Over the Cuckoo's Nest (1975)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>661</td>\n",
       "      <td>3</td>\n",
       "      <td>2000-12-31 23:35:09</td>\n",
       "      <td>James and the Giant Peach (1996)</td>\n",
       "      <td>Animation|Children's|Musical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>914</td>\n",
       "      <td>3</td>\n",
       "      <td>2000-12-31 23:32:48</td>\n",
       "      <td>My Fair Lady (1964)</td>\n",
       "      <td>Musical|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>3408</td>\n",
       "      <td>4</td>\n",
       "      <td>2000-12-31 23:04:35</td>\n",
       "      <td>Erin Brockovich (2000)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>2355</td>\n",
       "      <td>5</td>\n",
       "      <td>2001-01-07 00:38:11</td>\n",
       "      <td>Bug's Life, A (1998)</td>\n",
       "      <td>Animation|Children's|Comedy</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_usuario  id_peli  puntuacion               Fecha  \\\n",
       "0           1     1193           5 2000-12-31 23:12:40   \n",
       "1           1      661           3 2000-12-31 23:35:09   \n",
       "2           1      914           3 2000-12-31 23:32:48   \n",
       "3           1     3408           4 2000-12-31 23:04:35   \n",
       "4           1     2355           5 2001-01-07 00:38:11   \n",
       "\n",
       "                                   Titulo                        Genero  \n",
       "0  One Flew Over the Cuckoo's Nest (1975)                         Drama  \n",
       "1        James and the Giant Peach (1996)  Animation|Children's|Musical  \n",
       "2                     My Fair Lady (1964)               Musical|Romance  \n",
       "3                  Erin Brockovich (2000)                         Drama  \n",
       "4                    Bug's Life, A (1998)   Animation|Children's|Comedy  "
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "valpel= pd.merge(valoraciones,peliculas, on=['id_peli'],how='left')\n",
    "valpel.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id_usuario</th>\n",
       "      <th>id_peli</th>\n",
       "      <th>puntuacion</th>\n",
       "      <th>Fecha</th>\n",
       "      <th>Titulo</th>\n",
       "      <th>Genero</th>\n",
       "      <th>genero</th>\n",
       "      <th>edad</th>\n",
       "      <th>Ocupacion</th>\n",
       "      <th>CP</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1193</td>\n",
       "      <td>5</td>\n",
       "      <td>2000-12-31 23:12:40</td>\n",
       "      <td>One Flew Over the Cuckoo's Nest (1975)</td>\n",
       "      <td>Drama</td>\n",
       "      <td>F</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>48067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>661</td>\n",
       "      <td>3</td>\n",
       "      <td>2000-12-31 23:35:09</td>\n",
       "      <td>James and the Giant Peach (1996)</td>\n",
       "      <td>Animation|Children's|Musical</td>\n",
       "      <td>F</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>48067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>914</td>\n",
       "      <td>3</td>\n",
       "      <td>2000-12-31 23:32:48</td>\n",
       "      <td>My Fair Lady (1964)</td>\n",
       "      <td>Musical|Romance</td>\n",
       "      <td>F</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>48067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>3408</td>\n",
       "      <td>4</td>\n",
       "      <td>2000-12-31 23:04:35</td>\n",
       "      <td>Erin Brockovich (2000)</td>\n",
       "      <td>Drama</td>\n",
       "      <td>F</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>48067</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>2355</td>\n",
       "      <td>5</td>\n",
       "      <td>2001-01-07 00:38:11</td>\n",
       "      <td>Bug's Life, A (1998)</td>\n",
       "      <td>Animation|Children's|Comedy</td>\n",
       "      <td>F</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>48067</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id_usuario  id_peli  puntuacion               Fecha  \\\n",
       "0           1     1193           5 2000-12-31 23:12:40   \n",
       "1           1      661           3 2000-12-31 23:35:09   \n",
       "2           1      914           3 2000-12-31 23:32:48   \n",
       "3           1     3408           4 2000-12-31 23:04:35   \n",
       "4           1     2355           5 2001-01-07 00:38:11   \n",
       "\n",
       "                                   Titulo                        Genero  \\\n",
       "0  One Flew Over the Cuckoo's Nest (1975)                         Drama   \n",
       "1        James and the Giant Peach (1996)  Animation|Children's|Musical   \n",
       "2                     My Fair Lady (1964)               Musical|Romance   \n",
       "3                  Erin Brockovich (2000)                         Drama   \n",
       "4                    Bug's Life, A (1998)   Animation|Children's|Comedy   \n",
       "\n",
       "  genero  edad  Ocupacion     CP  \n",
       "0      F     1         10  48067  \n",
       "1      F     1         10  48067  \n",
       "2      F     1         10  48067  \n",
       "3      F     1         10  48067  \n",
       "4      F     1         10  48067  "
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tabla_final= pd.merge(valpel,usuarios, on=['id_usuario'], how='left')\n",
    "tabla_final.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [],
   "source": [
    "punt_media=tabla_final.groupby(['Titulo', 'genero']).mean().unstack().puntuacion\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>genero</th>\n",
       "      <th>F</th>\n",
       "      <th>M</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Titulo</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>$1,000,000 Duck (1971)</th>\n",
       "      <td>3.375000</td>\n",
       "      <td>2.761905</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>'Night Mother (1986)</th>\n",
       "      <td>3.388889</td>\n",
       "      <td>3.352941</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>'Til There Was You (1997)</th>\n",
       "      <td>2.675676</td>\n",
       "      <td>2.733333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>'burbs, The (1989)</th>\n",
       "      <td>2.793478</td>\n",
       "      <td>2.962085</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...And Justice for All (1979)</th>\n",
       "      <td>3.828571</td>\n",
       "      <td>3.689024</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "genero                                F         M\n",
       "Titulo                                           \n",
       "$1,000,000 Duck (1971)         3.375000  2.761905\n",
       "'Night Mother (1986)           3.388889  3.352941\n",
       "'Til There Was You (1997)      2.675676  2.733333\n",
       "'burbs, The (1989)             2.793478  2.962085\n",
       "...And Justice for All (1979)  3.828571  3.689024"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "punt_media.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 4. Mejor valoradas por mujeres"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Ahora queremos conocer las películas mejor valoradas por las mujeres. Crea una función llamada __mejor_valoradas_mujeres__. Utiliza el dataFrame devuelto por la función __puntuacion_media__ del apartado anterior y devuelve un DataFrame ordenado de forma apropiada. \n",
    "\n",
    "__Nota__:\n",
    "\n",
    "* Utiliza la función __sort_values__ para ordenar los resultados."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# Sol: \n",
    "def mejor_valoradas_mujeres(data):\n",
    "    \"\"\" Calcula las películas mejor valoradas por las mujeres\n",
    "    Args:\n",
    "         @type data: dataframe             \n",
    "\n",
    "    Returns: \n",
    "        @rtype: dataframe\n",
    "    \n",
    "    Examples:\n",
    "     >>> mejor_valoradas_mujeres(data)\n",
    "     genero_u                                               F           M\n",
    "     titulo\n",
    "        Clean Slate (Coup de Torchon) (1981)         5.000000    3.857143\n",
    "        Ballad of Narayama, The (Narayama Bushiko)   5.000000    3.428571\n",
    "        Raw Deal (1948)                              5.000000    3.307692\n",
    "        Bittersweet Motel (2000)                     5.000000    NaN\n",
    "        Skipped Parts (2000)                         5.000000    4.000000\n",
    "        Lamerica (1994)                              5.000000    4.666667"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "def mejor_valoradas_mujeres(data):\n",
    "    data=data.sort_values('F', ascending = False)\n",
    "    return (data)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>genero</th>\n",
       "      <th>F</th>\n",
       "      <th>M</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Titulo</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Clean Slate (Coup de Torchon) (1981)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.857143</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ballad of Narayama, The (Narayama Bushiko) (1958)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.428571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Raw Deal (1948)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.307692</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bittersweet Motel (2000)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Skipped Parts (2000)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lamerica (1994)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>4.666667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Gambler, The (A J�t�kos) (1997)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.166667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Brother, Can You Spare a Dime? (1975)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.642857</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ayn Rand: A Sense of Life (1997)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24 7: Twenty Four Seven (1997)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.750000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Twice Upon a Yesterday (1998)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.222222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Woman of Paris, A (1923)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>2.428571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>I Am Cuba (Soy Cuba/Ya Kuba) (1964)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>4.750000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Gate of Heavenly Peace, The (1995)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>5.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>For the Moment (1994)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Country Life (1994)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Prisoner of the Mountains (Kavkazsky Plennik) (1996)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Other Side of Sunday, The (S�ndagsengler) (1996)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>2.928571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Saltmen of Tibet, The (1997)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.571429</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Big Combo, The (1955)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.600000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>One Little Indian (1973)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Message to Love: The Isle of Wight Festival (1996)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.833333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Belly (1998)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Song of Freedom (1936)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Coldblooded (1995)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.588235</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Battling Butler (1926)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.222222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Dancemaker (1998)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.250000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>World of Apu, The (Apur Sansar) (1959)</th>\n",
       "      <td>4.842105</td>\n",
       "      <td>4.189189</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Hearts and Minds (1996)</th>\n",
       "      <td>4.833333</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Apple, The (Sib) (1998)</th>\n",
       "      <td>4.750000</td>\n",
       "      <td>4.600000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tinseltown (1998)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tokyo Fist (1995)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tough and Deadly (1995)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Trans (1998)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Trois (2000)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Two Thousand Maniacs! (1964)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.266667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ugly, The (1997)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.888889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ulysses (Ulisse) (1954)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>5.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Underworld (1997)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Uninvited Guest, An (2000)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Vampyros Lesbos (Las Vampiras) (1970)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Venice/Venice (1992)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Very Natural Thing, A (1974)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.333333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Voyage to the Beginning of the World (1997)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Waiting Game, The (2000)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Walking Dead, The (1995)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.684211</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Waltzes from Vienna (1933)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>War at Home, The (1996)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Wend Kuuni (God's Gift) (1982)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Where's Marlowe? (1999)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>White Boys (1999)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Wild Bill (1995)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.146341</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Windows (1980)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Wings of Courage (1995)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>With Byrd at the South Pole (1930)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>With Friends Like These... (1998)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Wooden Man's Bride, The (Wu Kui) (1994)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Year of the Horse (1997)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.250000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zachariah (1971)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zero Kelvin (Kj�rlighetens kj�tere) (1995)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>3.500000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3706 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "genero                                                     F         M\n",
       "Titulo                                                                \n",
       "Clean Slate (Coup de Torchon) (1981)                5.000000  3.857143\n",
       "Ballad of Narayama, The (Narayama Bushiko) (1958)   5.000000  3.428571\n",
       "Raw Deal (1948)                                     5.000000  3.307692\n",
       "Bittersweet Motel (2000)                            5.000000       NaN\n",
       "Skipped Parts (2000)                                5.000000  4.000000\n",
       "Lamerica (1994)                                     5.000000  4.666667\n",
       "Gambler, The (A J�t�kos) (1997)                     5.000000  3.166667\n",
       "Brother, Can You Spare a Dime? (1975)               5.000000  3.642857\n",
       "Ayn Rand: A Sense of Life (1997)                    5.000000  4.000000\n",
       "24 7: Twenty Four Seven (1997)                      5.000000  3.750000\n",
       "Twice Upon a Yesterday (1998)                       5.000000  3.222222\n",
       "Woman of Paris, A (1923)                            5.000000  2.428571\n",
       "I Am Cuba (Soy Cuba/Ya Kuba) (1964)                 5.000000  4.750000\n",
       "Gate of Heavenly Peace, The (1995)                  5.000000  5.000000\n",
       "For the Moment (1994)                               5.000000  3.000000\n",
       "Country Life (1994)                                 5.000000  2.000000\n",
       "Prisoner of the Mountains (Kavkazsky Plennik) (...  5.000000  3.692308\n",
       "Other Side of Sunday, The (S�ndagsengler) (1996)    5.000000  2.928571\n",
       "Saltmen of Tibet, The (1997)                        5.000000  3.571429\n",
       "Big Combo, The (1955)                               5.000000  3.600000\n",
       "One Little Indian (1973)                            5.000000       NaN\n",
       "Message to Love: The Isle of Wight Festival (1996)  5.000000  3.833333\n",
       "Belly (1998)                                        5.000000  3.000000\n",
       "Song of Freedom (1936)                              5.000000       NaN\n",
       "Coldblooded (1995)                                  5.000000  3.588235\n",
       "Battling Butler (1926)                              5.000000  3.222222\n",
       "Dancemaker (1998)                                   5.000000  3.250000\n",
       "World of Apu, The (Apur Sansar) (1959)              4.842105  4.189189\n",
       "Hearts and Minds (1996)                             4.833333  4.000000\n",
       "Apple, The (Sib) (1998)                             4.750000  4.600000\n",
       "...                                                      ...       ...\n",
       "Tinseltown (1998)                                        NaN  2.000000\n",
       "Tokyo Fist (1995)                                        NaN  2.500000\n",
       "Tough and Deadly (1995)                                  NaN  2.000000\n",
       "Trans (1998)                                             NaN  3.000000\n",
       "Trois (2000)                                             NaN  2.000000\n",
       "Two Thousand Maniacs! (1964)                             NaN  3.266667\n",
       "Ugly, The (1997)                                         NaN  1.888889\n",
       "Ulysses (Ulisse) (1954)                                  NaN  5.000000\n",
       "Underworld (1997)                                        NaN  1.000000\n",
       "Uninvited Guest, An (2000)                               NaN  1.000000\n",
       "Vampyros Lesbos (Las Vampiras) (1970)                    NaN  3.333333\n",
       "Venice/Venice (1992)                                     NaN  1.000000\n",
       "Very Natural Thing, A (1974)                             NaN  3.333333\n",
       "Voyage to the Beginning of the World (1997)              NaN  4.000000\n",
       "Waiting Game, The (2000)                                 NaN  2.000000\n",
       "Walking Dead, The (1995)                                 NaN  2.684211\n",
       "Waltzes from Vienna (1933)                               NaN  1.000000\n",
       "War at Home, The (1996)                                  NaN  2.500000\n",
       "Wend Kuuni (God's Gift) (1982)                           NaN  4.000000\n",
       "Where's Marlowe? (1999)                                  NaN  4.000000\n",
       "White Boys (1999)                                        NaN  1.000000\n",
       "Wild Bill (1995)                                         NaN  3.146341\n",
       "Windows (1980)                                           NaN  1.000000\n",
       "Wings of Courage (1995)                                  NaN  3.000000\n",
       "With Byrd at the South Pole (1930)                       NaN  2.000000\n",
       "With Friends Like These... (1998)                        NaN  4.000000\n",
       "Wooden Man's Bride, The (Wu Kui) (1994)                  NaN  3.000000\n",
       "Year of the Horse (1997)                                 NaN  3.250000\n",
       "Zachariah (1971)                                         NaN  3.500000\n",
       "Zero Kelvin (Kj�rlighetens kj�tere) (1995)               NaN  3.500000\n",
       "\n",
       "[3706 rows x 2 columns]"
      ]
     },
     "execution_count": 93,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mejor_valoradas_mujeres(punt_media)"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.1"
  },
  "toc": {
   "colors": {
    "hover_highlight": "#DAA520",
    "running_highlight": "#FF0000",
    "selected_highlight": "#FFD700"
   },
   "moveMenuLeft": true,
   "nav_menu": {
    "height": "122px",
    "width": "252px"
   },
   "navigate_menu": true,
   "number_sections": true,
   "sideBar": true,
   "threshold": 4,
   "toc_cell": false,
   "toc_section_display": "block",
   "toc_window_display": false,
   "widenNotebook": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
